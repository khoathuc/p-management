generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum WorkspaceRole {
  Member
  Owner
  Admin
}

enum UserStatus {
  Active
  Deactivated
}

model User {
  id String @id @default(cuid())

  username String @unique
  email    String @unique

  password String
  status   Int

  firstName          String?
  lastName           String?
  avatar             String?
  currentWorkspaceId String?
  emailVerified      Boolean @default(false)
  refreshToken       String? @unique

  //data
  data Json?

  // timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Workspace {
  id     String  @id @default(cuid())
  userId String
  name   String  @unique
  logo   String?

  members String[]
  owners  String[]
  admins  String[]

  //data
  data Json?

  // timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId])
}

model WorkspaceFollowing {
  id   String        @id @default(cuid())
  role WorkspaceRole @default(Member)

  objectId String
  userId   String

  name String
  logo String

  creating  Boolean
  ownering  Boolean
  is_admin  Boolean
  is_member Boolean

  //data
  data Json?

  // timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId])
}

model Invitation {
  id String @id @default(cuid())

  userId         String
  workspaceId String

  role           WorkspaceRole @default(Member)
  email          String
  inviteAccepted Boolean?      @default(false)
  token          String?

  //data
  data Json?

  // timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([workspaceId])
  @@index([workspaceId, userId])
}

model VerifyToken {
  id         String   @id @default(cuid())
  identifier String
  token      String   @unique
  expires    DateTime

  //data
  data Json?

  // timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  //workspace
  workspaceId String

  //index
  @@unique([identifier, token])

  @@index([workspaceId])
  @@index([workspaceId, identifier, token])
}

model ForgotPasswordToken {
  id         String   @id @default(cuid())
  userId     String   @unique
  token      String   @unique
  expires    DateTime
  //data
  data Json?

  // timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model AccessToken {
  id         String   @id @default(cuid())
  token      String   @unique
  expires    DateTime
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model RefreshToken {
  id         String   @id @default(cuid())
  token      String   @unique
  expires    DateTime
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}